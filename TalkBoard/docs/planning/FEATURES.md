# 💡 핵심 기능 명세서

## 📋 기능 목록

### 1. 추모관 관리

#### 1.1 추모관 생성
- **기능**: 고인을 위한 추모관 생성
- **입력 항목**:
  - 추모 대상 타입 (필수): '사람' 또는 '애완동물' 선택
  - 고인 이름 (필수)
  - 생애 요약 (선택)
  - 사진 (최대 5장)
  - 동영상 (YouTube 링크 또는 업로드)
  - 편지 (텍스트 또는 음성)
  - 기념일 (생일, 기일)
  - 공개/비공개 설정
- **타입별 차이점**:
  - **사람 추모관**: 전통적인 추모 분위기, "고인", "기일" 표현 사용
  - **애완동물 추모관**: 따뜻하고 밝은 분위기, "반려동물", "떠난 날" 표현 사용
- **출력**: 추모관 ID, 생성 일시

#### 1.2 추모관 수정
- **기능**: 생성한 추모관 정보 수정
- **권한**: 추모관 생성자만 수정 가능
- **수정 가능 항목**: 모든 입력 항목

#### 1.3 추모관 삭제
- **기능**: 추모관 삭제 (소프트 삭제)
- **권한**: 추모관 생성자만 삭제 가능
- **복원**: 삭제된 추모관 복원 기능

#### 1.4 추모관 목록 조회
- **기능**: 내가 만든 추모관 리스트 조회
- **필터**: 
  - 추모 대상 타입 (사람/애완동물/전체)
  - 공개/비공개
  - 최신순/이름순
- **검색**: 고인 이름으로 검색

### 2. 콘텐츠 관리

#### 2.1 사진 업로드
- **기능**: 추모관에 사진 추가
- **제한**: 최대 5장
- **형식**: JPG, PNG
- **크기 제한**: 10MB 이하

#### 2.2 동영상 관리
- **기능**: YouTube 링크 또는 직접 업로드
- **형식**: MP4, YouTube 링크
- **크기 제한**: 100MB 이하 (업로드 시)

#### 2.3 편지 작성
- **기능**: 텍스트 또는 음성으로 편지 작성
- **텍스트 편지**: 마크다운 지원
- **음성 편지**: 녹음 및 재생 기능
- **홈 화면 공개 설정**: 편지 작성 시 홈 화면 공개 여부 선택
  - **공개**: 홈 화면 "가슴을 울리는 추모글"에 표시 가능
  - **비공개**: 추모관 내에서만 조회 가능
  - **기본값**: 비공개

### 3. 추모 활동

#### 3.1 방문 기록
- **기능**: 추모관 방문 시 자동 카운트
- **표시**: "이 추모관은 N명이 방문했습니다"
- **중복 방문**: 하루 1회만 카운트

#### 3.2 댓글 작성
- **기능**: 추모관에 위로 메시지 작성
- **형식**: 텍스트
- **수정/삭제**: 작성자만 가능

#### 3.3 기도 요청
- **기능**: 기도 요청 글 작성 및 함께 기도 참여
- **기도 카운트**: 함께 기도 버튼 클릭 시 카운트 증가
- **응답 댓글**: 기도 응답 메시지 작성

#### 3.4 감정 공유 게시판
- **기능**: 감정 나눔 글 작성
- **CRUD**: 글 작성, 조회, 수정, 삭제
- **좋아요**: 하트 아이콘으로 좋아요 표시
- **댓글**: 댓글 작성 및 조회

#### 3.5 후회 없는 편지 (Letters of No Regret)
- **기능**: 고인에게 전하지 못한 말, 후회, 조언을 편지 형식으로 공유
- **핵심 목적**: 
  - **고인에 대한 후회를 나중에 다른 사람이 보고 꼭 참고해서 후회 없이 하도록 돕는 것**
  - 고인의 가족이나 친구들이 살아생전 해주지 못한 아쉬움, 후회, 조언을 편지 형식으로 공유
  - **다른 사용자들이 이를 읽고 자신의 삶에서 후회하지 않도록 참고하고 실천할 수 있도록 돕는 것**
  - 추모를 넘어 공감과 배움, 그리고 실천의 공간으로 확장
  - "그때 더 안아줄 걸 그랬어요. 지금 누군가에게 그 마음을 전하세요." 같은 메시지를 통해 현재 살아있는 사람들에게 행동을 촉구
- **주요 기능**:
  - **편지 작성**: 고인에게 전하지 못한 말, 후회, 조언 등을 텍스트로 작성
  - **공개 여부 설정**: 전체 공개 / 익명 공개 / 나만 보기 선택 가능
  - **카테고리 선택**: 가족, 친구, 연인, 직장, 신앙 등 관계 유형 선택
  - **추모관 연결**: 작성한 추모관에 편지를 연결하여 추모관 내 "후회 없는 편지" 탭에 표시
  - **공감 버튼**: 다른 사용자들이 공감할 수 있도록 하트 또는 "도움이 되었어요" 버튼 제공
  - **댓글 기능**: 다른 사용자들이 자신의 경험이나 감정을 나눌 수 있음
  - **필터 기능**: 관계 유형별, 공감순, 최신순으로 편지 탐색 가능
- **익명 작성**: 감정 표현에 부담 없도록 익명 작성 가능
- **감성적 메시지**: 
  - "그때 더 안아줄 걸 그랬어요. 지금 누군가에게 그 마음을 전하세요."
  - "이 편지를 읽는 당신은, 아직 늦지 않았습니다."
  - "후회하지 않는 사랑을 위해, 지금 바로 행동하세요."
- **UI 구성**:
  - 편지 카드: 제목 + 요약 + 공감 수 + 관계 유형
  - 상세 보기: 편지 전문 + 댓글 영역 + 공감 버튼
  - 작성 화면: 텍스트 입력창, 관계 유형 선택, 공개 여부 토글, 추모관 연결 (선택)
- **확장 가능성**:
  - AI 추천 편지: 사용자의 상황에 맞는 편지 자동 추천
  - 기념일 편지 알림: 고인의 기일에 맞춰 편지 자동 노출
  - 음성 편지 기능: 텍스트 대신 음성으로 남기기

#### 3.6 AI 기억 기반 답장 생성 (AI Memory-Based Reply Generation)
- **기능**: 고인과의 실제 대화를 기반으로 AI가 말투·관계·감정을 학습하여 고인의 말투로 답장을 생성
- **목적**: 
  - 고인과 나눴던 실제 대화를 기반으로 AI가 말투·관계·감정을 학습
  - 사용자가 고인에게 답장을 작성하거나, 고인의 말투로 위로받는 경험을 제공
  - 단순한 텍스트 생성이 아니라, 기억을 재현하는 감성적 인터페이스
- **주요 기능**:
  - **대화 캡처 업로드**: 카카오톡, 문자, 메신저 대화 캡처 이미지 또는 텍스트 업로드
  - **AI 분석**: 
    - 말투 분석: 존댓말/반말, 어투, 자주 쓰는 표현
    - 관계성 추론: 가족/연인/친구/지인 등 관계 유형
    - 감정 키워드 추출: 사랑, 그리움, 위로, 감사, 미안함 등
    - 대화 패턴 분석: 질문/응답 구조, 유머, 애칭 등
  - **답장 생성**: 사용자가 고인에게 말하고 싶은 내용을 입력하면 AI가 고인의 말투로 답장 생성
  - **음성 변환 (선택)**: TTS API로 음성 답장 제공
  - **답장 저장**: 생성된 답장을 추모관에 저장하여 나중에 다시 볼 수 있음
- **기술적 구현**:
  - 이미지 OCR 처리: Firebase ML Kit 또는 외부 OCR API로 대화 캡처 이미지에서 텍스트 추출
  - 텍스트 분석: NLP 기반 말투·감정·관계 추출
  - 답장 생성: OpenAI GPT 또는 Claude API 활용
  - 음성 변환: TTS API (Google TTS, AWS Polly 등)
- **UI 위치**: 추모관 상세 화면 > "AI 기억 답장" 탭
- **사용 예시**:
  - 입력: "엄마, 오늘도 당신이 너무 보고 싶어요. 요즘은 많이 힘들어요."
  - AI 답장 (엄마 말투): "우리 해민이, 엄마는 늘 네 곁에 있어. 힘들 땐 울어도 괜찮아. 엄마는 네가 웃는 날을 기다릴게."

#### 3.7 유언장 (Will & Testament)
- **기능**: 미리 유언을 작성하여 남기고, 다른 사람들의 유언을 참고하여 자신의 유언을 작성할 수 있는 기능
- **목적**: 
  - 살아있는 동안 미리 유언을 생각하고 작성할 수 있도록 돕는 것
  - 다른 사람들이 작성한 유언을 읽고 참고하여 자신의 유언을 작성할 수 있도록 공유
  - 유언을 공개/비공개로 설정하여 선택적으로 공유
  - 후회 없는 인생을 살고 떠날 준비를 돕는 것
- **주요 기능**:
  - **유언 작성**: 미리 유언을 작성하여 저장
  - **공개 여부 설정**: 전체 공개 / 비공개 선택 가능
  - **유언 공유**: 공개된 유언을 다른 사람들이 읽고 참고할 수 있음
  - **유언 카테고리**: 가족, 친구, 재산, 마지막 인사 등 카테고리별 작성
  - **유언 템플릿**: 참고할 수 있는 유언 템플릿 제공
  - **유언 수정/삭제**: 작성한 유언을 수정하거나 삭제 가능
  - **유언 조회**: 내 유언 조회 및 공개된 유언 탐색
  - **유언 공감**: 다른 사람의 유언에 공감 버튼
  - **유언 댓글**: 유언에 대한 댓글 작성 (선택적)
- **카테고리**:
  - 가족에게: 가족에게 전하는 마지막 말
  - 친구에게: 친구에게 전하는 마지막 말
  - 재산 및 유산: 재산 분배, 유산 관리
  - 마지막 인사: 모든 사람에게 전하는 마지막 인사
  - 특별한 메시지: 특정인에게 전하는 특별한 메시지
- **공개 설정**:
  - **전체 공개**: 모든 사용자가 조회 가능, 다른 사람들이 참고 가능
  - **비공개**: 나만 조회 가능, 다른 사람들에게 공유되지 않음
- **템플릿 제공**: 
  - 기본 유언 템플릿 제공
  - 카테고리별 템플릿 제공
  - 템플릿을 수정하여 자신만의 유언 작성
- **UI 위치**: 마이페이지 또는 별도 화면 (하단 네비게이션 또는 메뉴)
- **사용 예시**:
  - "가족들에게: 항상 사랑해. 내가 없는 날에도 서로 아껴주고 행복하게 살아줘."
  - "재산 관련: 내 재산은 모두 자녀들에게 균등하게 나누어 주세요."

#### 3.8 상호 위로 매칭 시스템 (Mutual Comfort Matching)
- **기능**: 유사한 상실 경험을 가진 사람들을 매칭하여 서로의 빈자리를 보완하고 위로를 나누는 기능
- **목적**: 
  - 엄마를 잃은 딸과 딸을 잃은 엄마처럼, 서로가 잃은 사람과 유사한 관계의 사람을 찾아 연결
  - 서로의 빈자리를 채워주고 위로와 공감을 나누는 의미 있는 관계 형성
  - 혼자 견디기 어려운 슬픔을 함께 나누며 치유의 여정을 함께 걸어갈 수 있도록 돕는 것
- **주요 기능**:
  - **프로필 등록**: 상실한 관계 유형, 간단한 자기소개, 매칭 조건 설정
  - **매칭 유형**: 
    - 엄마 ↔ 딸
    - 아빠 ↔ 아들
    - 엄마 ↔ 아들
    - 아빠 ↔ 딸
    - 친구 ↔ 친구
    - 형제자매 ↔ 형제자매
  - **구인/구직 형식**: 
    - **구인**: 상실한 사람을 찾는 사람 (예: 딸을 잃은 엄마가 딸을 찾음)
    - **구직**: 관계를 찾는 사람 (예: 엄마를 잃은 딸이 엄마 같은 관계를 찾음)
  - **매칭 조건 설정**: 
    - 나이대 (선호)
    - 지역 (선택)
    - 성격 유형 (선택)
    - 상실 경과 시간 (선택)
  - **매칭 신청**: 관심 있는 프로필에 매칭 신청
  - **매칭 수락/거절**: 신청받은 매칭을 검토하여 수락 또는 거절
  - **채팅 기능**: 매칭 성사 후 안전한 채팅 공간 제공
  - **프로필 검증**: 실명 인증 또는 검증된 프로필 표시 (선택)
  - **신고 기능**: 부적절한 행위 신고
  - **매칭 관리**: 활성 매칭 목록, 매칭 종료 기능
- **안전 기능**:
  - **익명성 보호**: 실명 공개 여부 선택 가능
  - **채팅 모니터링**: 부적절한 내용 자동 감지 (선택)
  - **신고 시스템**: 부적절한 사용자 신고 및 차단
  - **이용 약관 동의**: 매칭 서비스 이용 시 별도 약관 동의 필수
  - **프로필 검증**: 선택적 실명 인증 또는 추모관 연동 검증
- **매칭 프로세스**:
  1. 프로필 등록 (구인 또는 구직 선택)
  2. 매칭 조건 설정
  3. 매칭 추천 받기 또는 직접 탐색
  4. 관심 있는 프로필에 매칭 신청
  5. 상대방이 신청 검토 후 수락/거절
  6. 수락 시 채팅 기능 활성화
  7. 관계 발전 및 지속 (또는 매칭 종료)
- **UI 위치**: 마이페이지 또는 별도 화면 (하단 네비게이션 또는 메뉴)
- **주의사항**:
  - 매우 민감한 기능이므로 사용자의 동의와 안전을 최우선으로 고려
  - 명확한 이용 약관 및 개인정보 처리 방침 제공
  - 신고 및 차단 기능 강화
  - 전문 상담사 연결 옵션 제공 (선택)

#### 3.9 영원한 시간 (Eternal Time)
- **기능**: 고인이 돌아가신 날부터 새로운 삶의 시간을 시각화
- **의미**: 
  - 죽음은 끝이 아니라 새로운 삶의 시작
  - 고인이 돌아가신 순간부터 새로운 시간이 흐르기 시작
  - 죽음으로 인해 다시 태어난 것처럼 새로운 삶의 시간을 가지게 됨
  - 이는 위로와 희망을 주는 의미
- **표시 방식**:
  - 고인이 돌아가신 날부터 경과된 시간을 실시간으로 표시
  - "새로운 삶의 시간: N년 N개월 N일 N시간 N분"
  - 시계나 타이머처럼 시간이 흐르는 것을 시각적으로 표현
  - 부드럽고 따뜻한 애니메이션 효과
- **위치**: 추모관 상세 화면 상단 또는 별도 섹션
- **디자인**: 
  - 따뜻한 톤의 색상 (베이지, 크림)
  - 부드러운 시계 아이콘 또는 시간 흐름 애니메이션
  - "영원한 시간이 흐르고 있습니다" 같은 위로의 메시지
- **심리적 효과**:
  - 죽음 이후에도 시간이 흐른다는 것을 보여줌으로써 위로 제공
  - 고인이 새로운 삶을 살고 있다는 희망적 메시지
  - 시간이 지나도 기억은 영원하다는 의미 전달

### 4. 추모금 시스템

#### 4.1 추모금 전달
- **기능**: 추모금 결제 및 전달
- **결제 방식**: 카드, 계좌이체, 간편결제
- **수수료**: 전달 금액의 5% 차감
- **유지비**: ₩1,900 차감
- **안내**: 수수료 및 유지비 차감 안내 메시지 표시

#### 4.2 추모금 수령
- **기능**: 수령자 현금화 가능
- **출금**: 계좌로 출금 가능
- **내역**: 추모금 수령 내역 조회

### 5. 알림 시스템

#### 5.1 기념일 알림
- **기능**: 고인의 생일/기일에 푸시 알림
- **알림 내용**: 고인 이름, 날짜, "추모하러 가기" 링크
- **발송 시점**: 
  - 생일/기일 전날 오후 6시
  - 생일/기일 당일 오전 9시
  - 기념일 1주일 전 (선택)
- **대상**: 추모관 생성자 및 추모관을 좋아요한 사용자
- **설정**: 알림 수신 여부 설정 가능

#### 5.2 홈 화면 공개 제안 알림
- **기능**: 공감을 많이 받은 추모글에 대해 작성자에게 홈 화면 공개 제안
- **조건**: 
  - 좋아요 + 댓글 수 합계가 일정 기준 이상 (예: 10개 이상)
  - 편지가 비공개 상태일 때
  - 작성자가 홈 화면 공개를 아직 선택하지 않은 경우
- **알림 내용**: 
  - "당신의 추모글이 많은 공감을 받았습니다"
  - "홈 화면에 공개하여 더 많은 사람들과 나누시겠어요?"
  - 편지 내용 일부 미리보기
- **동작**:
  - 알림 클릭 시 공개 동의 화면으로 이동
  - "공개하기" / "나중에" 선택 가능
  - 공개 선택 시 홈 화면 "가슴을 울리는 추모글"에 자동 추가
  - 비공개 선택 시 알림은 닫히지만 나중에 다시 제안 가능

#### 5.3 댓글 알림
- **기능**: 추모관에 댓글이 달렸을 때 알림
- **알림 내용**: 댓글 작성자, 댓글 내용 일부, "댓글 보러 가기" 링크
- **발송 시점**: 댓글 작성 직후
- **대상**: 추모관 생성자
- **제한**: 같은 추모관에 1시간 내 여러 댓글이 달리면 묶어서 발송

#### 5.4 추모금 전달 알림
- **기능**: 추모관에 추모금이 전달되었을 때 알림
- **알림 내용**: 기부자 이름, 추모금 금액, "추모금 내역 보기" 링크
- **발송 시점**: 추모금 전달 직후
- **대상**: 추모관 생성자 (수령자)

#### 5.5 재활성화 알림
- **기능**: 유령 회원을 재활성화하기 위한 알림
- **발송 시점**: 
  - 마지막 접속 후 7일, 14일, 30일, 90일
  - 기념일 3일 전 (유령 회원)
  - 추모관에 새로운 활동이 있을 때 (유령 회원)
- **알림 내용**: 
  - "[고인 이름]님의 영원한 시간이 계속 흐르고 있습니다."
  - "새로운 삶의 시간: [N]년 [N]개월 [N]일"
  - "추모관 보러 가기" 버튼
- **대상**: 장기 미접속 사용자 (7일 이상)
- **제한**: 주 1회

#### 5.6 영원한 시간 알림
- **기능**: 돌아가신 분을 기억하고 추모하는 알림
- **발송 시점**: 
  - 매주 일요일 오전 9시 (주간)
  - 매월 1일 오전 9시 (월간)
  - 특별한 날 (1주년, 1개월, 100일, 1년, 2년, 5년 등)
- **알림 내용**: 
  - "[고인 이름]님의 새로운 삶의 시간이 계속 흐르고 있습니다."
  - "새로운 삶의 시간: [N]년 [N]개월 [N]일"
  - "[고인 이름]님을 기억하며 함께 추모합니다."
  - "추모관 보러 가기" 버튼
- **대상**: 추모관 생성자 및 추모관을 좋아요한 사용자
- **설정**: 알림 수신 여부 설정 가능

#### 5.7 기도 요청 알림
- **기능**: 새로운 기도 요청이 등록되었을 때 알림
- **알림 내용**: 작성자 이름, 기도 요청 제목, "함께 기도하기" 버튼
- **발송 시점**: 기도 요청 등록 직후
- **대상**: 모든 사용자 (알림 설정 ON인 경우)
- **제한**: 하루 최대 3개까지

#### 5.8 프리미엄 구독 만료 알림
- **기능**: 프리미엄 구독 만료 전 알림
- **알림 내용**: 만료 일정, "구독 갱신하기" 버튼
- **발송 시점**: 만료 3일 전, 만료일 당일
- **대상**: 프리미엄 구독자

#### 5.9 알림 설정
- **알림 종류별 ON/OFF**: 기념일, 댓글, 기도, 재활성화, 영원한 시간 등
- **알림 수신 시간**: 기본 09:00 ~ 22:00 (기념일 제외)
- **알림 빈도 제한**: 같은 추모관 하루 최대 3개, 같은 사용자 하루 최대 5개

### 6. 프리미엄 기능

#### 6.1 프리미엄 추모관
- **기능**: 월 ₩1,900 또는 연 ₩19,000 구독
- **혜택**:
  - 무제한 사진 업로드
  - 동영상 직접 업로드 (크기 제한 없음)
  - 음성 편지 무제한
  - 광고 제거
  - 커스텀 배경

#### 6.2 디지털 헌화 아이템
- **기능**: 꽃, 배경, 음악 등 유료 아이템 구매
- **가격**: 아이템별 상이
- **적용**: 추모관에 장식으로 사용

### 7. 검색 및 추천

#### 7.1 추모관 검색
- **기능**: 공개된 추모관 검색
- **검색 조건**: 고인 이름, 생성자 이름
- **필터**: 
  - 추모 대상 타입 (사람/애완동물/전체)
  - 최신순, 공감순

#### 7.2 추천 추모글
- **기능**: 홈 화면에 추천 추모글 표시
- **기준**: 최근 등록, 공감을 많이 받은 추모관
- **표시 개수**: 3개
- **타입별 구분**: 사람/애완동물 탭 또는 필터로 구분 표시

#### 7.3 가슴을 울리는 추모글
- **기능**: 홈 화면에 감동적인 추모글 표시
- **선정 기준**:
  - 작성자가 홈 화면 공개에 동의한 편지
  - 좋아요 + 댓글 수가 많은 편지
  - 최근 작성된 감동적인 편지
- **표시 내용**:
  - 고인 이름
  - 편지 내용 일부 (4줄 미리보기)
  - 작성자 정보
  - 작성 시간
  - "전체 보기" 버튼
  - 공유 버튼
- **권한**: 작성자가 공개 동의한 경우에만 표시
- **타입별 구분**: 
  - 사람/애완동물 탭 또는 필터로 구분
  - 각 타입에 맞는 아이콘 표시 (사람: 하트, 애완동물: 발자국/고양이/강아지 아이콘)

#### 7.4 감사 혜택 배너
- **기능**: 홈 화면에 진행 중인 주요 감사 혜택 배너 표시
- **표시 조건**: 
  - 진행 중인 감사 혜택 중 우선순위가 높은 혜택 1개
  - 사용자가 아직 참여하지 않은 감사 혜택
- **표시 내용**:
  - 감사 혜택 제목
  - 혜택 요약
  - 감사 혜택 기간
  - "자세히 보기" 버튼
- **클릭 동작**: 감사 혜택 상세 화면으로 이동

### 8. 추모관 공유
- **기능**: 추모관을 다른 사람들과 공유
- **공유 방식**:
  - 추모관 링크 생성
  - SNS 공유 (카카오톡, 페이스북, 트위터 등)
  - QR 코드 생성
- **공유 통계**: 공유 횟수, 공유를 통해 방문한 사람 수
- **권한**: 공개 추모관만 공유 가능

### 9. 추모관 통계
- **기능**: 추모관의 활동 통계를 시각화
- **통계 항목**:
  - 방문 수 그래프 (일별/월별)
  - 댓글 수 통계
  - 추모금 통계
  - 공감 수 통계
  - 공유 횟수 통계
- **표시 위치**: 추모관 상세 화면 또는 별도 통계 화면

### 10. 추모관 백업/내보내기
- **기능**: 추모관 데이터를 백업하거나 다른 형식으로 내보내기
- **내보내기 형식**:
  - 추모관 데이터 PDF 내보내기
  - 사진/영상 다운로드
  - 편지 텍스트 내보내기
  - 전체 데이터 백업 (JSON 형식)
- **권한**: 추모관 생성자만 가능

## 🔐 권한 관리

### 사용자 권한
- **일반 사용자**: 추모관 생성, 댓글 작성, 기도 참여
- **추모관 생성자**: 추모관 수정/삭제, 추모금 수령, 추모관 백업/내보내기
- **프리미엄 사용자**: 프리미엄 기능 사용

### 추모관 권한
- **공개**: 모든 사용자가 조회 가능, 공유 가능
- **비공개**: 생성자만 조회 가능, 공유 불가

