# 📋 남은 작업 및 기능 구현 가이드

## ✅ 완료된 작업

### 기획 및 설계
- ✅ 앱 기획서 작성 (FEATURES.md, SCREENS.md, SCREEN_LAYOUTS.md)
- ✅ 기능 분석 및 추가 제안 (FEATURE_ANALYSIS.md)
- ✅ 데이터 구조 설계 (DATA_STRUCTURE.md)
- ✅ 기술 스택 선정 (TECH_STACK.md)
- ✅ 초기 데이터 생성 가이드 (INITIAL_DATA.md)
- ✅ UI 프리뷰 화면 구현 (15개 화면)
- ✅ 홈 화면 기능 설명 섹션 추가

### 현재 상태
- **기획 완료도**: 100% ✅
- **UI 프리뷰**: 100% ✅
- **실제 기능 구현**: 0% (기획만 완료)

---

## 🚧 남은 작업

### 1. Flutter 앱 개발 (핵심 기능)

#### 1.1 추모관 관리 기능
- [ ] **추모관 생성 화면 구현**
  - Step 1: 추모 대상 선택 (사람/애완동물)
  - Step 2: 기본 정보 입력 (이름, 생애 요약)
  - Step 3: 사진 업로드 (최대 5장, 프리미엄: 무제한)
  - Step 4: 동영상 업로드 (YouTube 링크 또는 직접 업로드)
  - Step 5: 편지 작성 (텍스트/음성, 홈 화면 공개 설정)
  - Step 6: 설정 (기념일, 공개/비공개)
  - Firestore에 저장

- [ ] **추모관 목록 화면 구현**
  - 내가 만든 추모관 리스트 조회
  - 검색 기능 (고인 이름)
  - 필터 기능 (타입, 공개/비공개, 정렬)
  - 편집/삭제 버튼

- [ ] **추모관 상세 화면 구현**
  - 고인 정보 표시
  - 영원한 시간 (Eternal Time) 실시간 표시
  - 사진 갤러리 (슬라이드/그리드)
  - 동영상 재생
  - 편지 표시 (텍스트/음성)
  - 댓글 작성 및 조회
  - 방문 수 표시
  - 추모금 전달 버튼 (사람 추모관만)
  - 공유, 통계, 백업/내보내기 버튼

- [ ] **추모관 수정 화면 구현**
  - 기존 정보 불러오기
  - 단계별 수정
  - Firestore 업데이트

- [ ] **추모관 삭제 기능**
  - 소프트 삭제 (deletedAt 필드 설정)
  - 삭제된 추모관 복원 기능

#### 1.2 콘텐츠 관리 기능
- [ ] **사진 업로드**
  - 이미지 선택 (image_picker)
  - Firebase Storage 업로드
  - 이미지 리사이징 (선택)
  - 미리보기
  - 삭제 기능

- [ ] **동영상 관리**
  - YouTube 링크 입력 및 검증
  - 동영상 직접 업로드 (Firebase Storage)
  - 썸네일 생성
  - 재생 기능

- [ ] **편지 작성**
  - 텍스트 편지: 마크다운 에디터
  - 음성 편지: 녹음 기능 (record 패키지)
  - 음성 재생 기능 (audioplayers)
  - 홈 화면 공개 설정 토글

#### 1.3 추모 활동 기능
- [ ] **방문 기록**
  - 추모관 방문 시 자동 카운트
  - 하루 1회만 카운트 (중복 방지)
  - Firestore에 visit 기록 저장

- [ ] **댓글 시스템**
  - 댓글 작성
  - 댓글 조회 (실시간)
  - 댓글 수정/삭제 (작성자만)
  - Firestore comments 컬렉션

- [ ] **기도 요청**
  - 기도 요청 글 작성
  - 함께 기도하기 버튼 (카운트 증가)
  - 기도 응답 댓글
  - 기도 완료 체크
  - Firestore prayers 컬렉션

- [ ] **감정 공유 게시판**
  - 글 작성/조회/수정/삭제
  - 좋아요 기능
  - 댓글 기능
  - 필터 (공감글, 최신글, 추천글)
  - Firestore emotions 컬렉션

- [ ] **영원한 시간 (Eternal Time)**
  - 고인이 돌아가신 날부터 경과 시간 계산
  - 실시간 업데이트 (Timer)
  - 시각적 애니메이션
  - "새로운 삶의 시간: N년 N개월 N일 N시간 N분" 표시

#### 1.4 추모금 시스템
- [ ] **추모금 전달**
  - 금액 입력
  - 수수료 및 유지비 계산 안내
  - 결제 수단 선택
  - 결제 API 연동
  - Firestore donations 컬렉션에 저장
  - Cloud Functions에서 수수료 차감 처리

- [ ] **추모금 수령**
  - 수령 가능 금액 조회
  - 출금 요청
  - 계좌 정보 입력
  - 출금 처리 (Cloud Functions)

- [ ] **추모금 내역**
  - 수령/전달 내역 조회
  - 필터 (전체/수령/전달, 최신순/금액순)
  - 상세 내역 표시

#### 1.5 알림 시스템
- [ ] **기념일 알림**
  - Cloud Functions에서 스케줄링
  - Firebase Cloud Messaging으로 푸시 알림
  - 알림 클릭 시 추모관 상세 화면 이동

- [ ] **홈 화면 공개 제안 알림**
  - 좋아요 + 댓글 수 합계 계산
  - 기준 이상 시 알림 발송
  - 알림 클릭 시 공개 동의 화면 이동
  - 공개 선택 시 홈 화면에 자동 추가

- [ ] **알림 설정 화면**
  - 각 알림 종류별 ON/OFF
  - 알림 수신 시간 설정

#### 1.6 프리미엄 기능
- [ ] **프리미엄 구독**
  - 구독 플랜 선택 (월간/연간)
  - 인앱 결제 연동 (iOS/Android)
  - 구독 상태 관리
  - Firestore subscriptions 컬렉션

- [ ] **디지털 헌화 아이템**
  - 아이템 목록 조회
  - 아이템 구매
  - 아이템 적용 (추모관에 장식)
  - Firestore items, userItems 컬렉션

#### 1.7 검색 및 추천
- [ ] **추모관 검색**
  - 고인 이름, 생성자 이름으로 검색
  - 필터 (타입, 최신순/공감순)
  - 검색 결과 표시

- [ ] **추천 추모글**
  - 홈 화면에 추천 추모글 표시
  - 최근 등록, 공감을 많이 받은 추모관
  - 타입별 구분 (사람/애완동물)

- [ ] **가슴을 울리는 추모글**
  - 홈 화면에 감동적인 추모글 표시
  - 작성자가 공개 동의한 편지만
  - 좋아요 + 댓글 수 기준
  - 타입별 구분

#### 1.8 공유 및 통계
- [ ] **추모관 공유**
  - 공유 링크 생성
  - QR 코드 생성
  - SNS 공유 (카카오톡, 페이스북, 트위터)
  - 공유 통계 기록 (Firestore shares 컬렉션)

- [ ] **추모관 통계**
  - 방문 수 그래프 (일별/월별)
  - 댓글 수 통계
  - 추모금 통계
  - 공감 수 통계
  - 공유 통계
  - Firestore memorialStats 컬렉션 (일별 집계)

#### 1.9 백업/내보내기
- [ ] **PDF 내보내기**
  - 추모관 전체 내용을 PDF로 생성
  - 이미지 포함
  - Firebase Storage에 저장

- [ ] **사진/영상 다운로드**
  - 모든 사진과 영상을 원본 품질로 다운로드
  - ZIP 파일로 압축

- [ ] **편지 텍스트 내보내기**
  - 모든 편지 내용을 텍스트 파일로 저장

- [ ] **전체 데이터 백업**
  - 추모관 전체 데이터를 JSON 형식으로 백업
  - Firebase Storage에 저장
  - Firestore backups 컬렉션에 기록

#### 1.10 책장 디자인
- [ ] **책장 화면 구현**
  - 과거/미래 시간축 표시
  - 추억 책 버튼
  - 시간별 추억 그룹화

- [ ] **추억 상세 화면**
  - 해당 시기의 추억 콘텐츠 표시
  - 사진, 편지, 댓글 표시
  - 시간축 탐색

### 2. Firebase 백엔드 구축

#### 2.1 Firestore 설정
- [ ] **컬렉션 생성**
  - users, memorials, comments, prayers, donations
  - emotions, emotionLikes, emotionComments
  - visits, subscriptions, items, userItems
  - shares, memorialStats, backups

- [ ] **인덱스 설정**
  - 복합 인덱스 생성
  - 쿼리 최적화

- [ ] **보안 규칙 설정**
  - 각 컬렉션별 접근 제어
  - 권한 관리

#### 2.2 Firebase Storage 설정
- [ ] **Storage 경로 구조 설정**
  - memorials/{memorialId}/photos/
  - memorials/{memorialId}/videos/
  - memorials/{memorialId}/letters/
  - memorials/{memorialId}/backups/

- [ ] **Storage 보안 규칙**
  - 업로드 권한 관리
  - 파일 크기 제한

#### 2.3 Cloud Functions 구현
- [ ] **기념일 알림 스케줄링**
  - 매일 실행하여 오늘 기념일 확인
  - 푸시 알림 발송

- [ ] **추모금 처리**
  - 수수료 및 유지비 차감
  - 수령자에게 알림

- [ ] **이미지 리사이징**
  - 업로드된 이미지 자동 리사이징
  - 썸네일 생성

- [ ] **푸시 알림 전송**
  - 댓글 알림
  - 기도 알림
  - 홈 화면 공개 제안 알림

- [ ] **통계 집계**
  - 일별 통계 자동 계산
  - memorialStats 컬렉션 업데이트

- [ ] **AI 초기 데이터 생성** (선택)
  - OpenAI/Claude API 연동
  - 초기 추모관 데이터 생성

#### 2.4 Firebase Cloud Messaging
- [ ] **푸시 알림 설정**
  - FCM 토큰 관리
  - 알림 수신 처리
  - 알림 클릭 시 화면 이동

### 3. 결제 시스템 연동

#### 3.1 인앱 결제 (iOS/Android)
- [ ] **iOS App Store In-App Purchase**
  - 구독 상품 등록
  - 구매 처리
  - 구독 상태 확인

- [ ] **Android Google Play Billing**
  - 구독 상품 등록
  - 구매 처리
  - 구독 상태 확인

#### 3.2 웹 결제 (선택)
- [ ] **PG사 연동**
  - 토스페이먼츠
  - 아임포트
  - 카카오페이
  - 네이버페이

#### 3.3 결제 검증
- [ ] **서버 검증**
  - Cloud Functions에서 결제 검증
  - 중복 결제 방지
  - 환불 처리

### 4. UI/UX 디자인

#### 4.1 Figma 디자인
- [ ] **모든 화면 디자인**
  - 홈 화면
  - 추모관 목록/상세/생성/수정
  - 기도 요청
  - 감정 공유 게시판
  - 마이페이지
  - 검색 화면
  - 책장 디자인

- [ ] **컴포넌트 디자인**
  - 버튼, 카드, 입력 필드
  - 아이콘, 이미지
  - 애니메이션

- [ ] **디자인 시스템**
  - 색상 팔레트
  - 타이포그래피
  - 간격 및 레이아웃

#### 4.2 디자인 구현
- [ ] **Flutter 위젯 구현**
  - 공통 컴포넌트
  - 화면별 위젯
  - 애니메이션 효과

### 5. 테스트

#### 5.1 단위 테스트
- [ ] **서비스 테스트**
  - AuthService 테스트
  - MemorialService 테스트
  - PaymentService 테스트

- [ ] **Provider 테스트**
  - AuthProvider 테스트
  - MemorialProvider 테스트

#### 5.2 통합 테스트
- [ ] **화면 테스트**
  - 각 화면의 기능 테스트
  - 화면 이동 테스트

- [ ] **Firebase 연동 테스트**
  - Firestore CRUD 테스트
  - Storage 업로드/다운로드 테스트
  - Cloud Functions 테스트

#### 5.3 사용자 테스트
- [ ] **베타 테스트**
  - TestFlight (iOS)
  - Internal Testing (Android)
  - 사용자 피드백 수집

### 6. 배포

#### 6.1 iOS 배포
- [ ] **App Store Connect 설정**
  - 앱 정보 등록
  - 스크린샷 및 설명
  - 개인정보 처리방침

- [ ] **빌드 및 제출**
  - Xcode 빌드
  - TestFlight 배포
  - App Store 제출

#### 6.2 Android 배포
- [ ] **Google Play Console 설정**
  - 앱 정보 등록
  - 스크린샷 및 설명
  - 개인정보 처리방침

- [ ] **빌드 및 제출**
  - Android 빌드
  - Internal Testing 배포
  - Google Play 제출

#### 6.3 웹 배포 (선택)
- [ ] **Firebase Hosting 설정**
  - 웹 앱 빌드
  - Firebase Hosting 배포
  - 도메인 연결

---

## 📊 우선순위별 작업 계획

### 🔴 Phase 1: 핵심 기능 (필수)
1. **인증 시스템**
   - 로그인/회원가입
   - 사용자 정보 관리

2. **추모관 기본 기능**
   - 추모관 생성/조회/수정/삭제
   - 사진 업로드
   - 편지 작성 (텍스트)

3. **댓글 시스템**
   - 댓글 작성/조회/수정/삭제

4. **Firebase 기본 설정**
   - Firestore 컬렉션 생성
   - Storage 설정
   - 보안 규칙 설정

### 🟡 Phase 2: 주요 기능 (중요)
5. **영원한 시간 (Eternal Time)**
   - 실시간 시간 계산 및 표시

6. **방문 기록**
   - 방문 카운트
   - 방문 통계

7. **추모금 시스템**
   - 추모금 전달
   - 추모금 수령
   - 결제 연동

8. **알림 시스템**
   - 기념일 알림
   - 푸시 알림 설정

### 🟢 Phase 3: 고급 기능 (선택)
9. **기도 요청**
   - 기도 요청 작성
   - 함께 기도하기

10. **감정 공유 게시판**
    - 글 작성/조회
    - 좋아요/댓글

11. **공유 및 통계**
    - 추모관 공유
    - 통계 화면

12. **백업/내보내기**
    - PDF 내보내기
    - 데이터 백업

### 🔵 Phase 4: 프리미엄 기능
13. **프리미엄 구독**
    - 구독 플랜
    - 인앱 결제

14. **디지털 헌화 아이템**
    - 아이템 구매
    - 아이템 적용

15. **책장 디자인**
    - 추억 탐색
    - 시간축 표시

---

## 🛠️ 개발 환경 설정

### 필요한 작업
- [ ] **Flutter 프로젝트 설정**
  - pubspec.yaml 업데이트 (필요한 패키지 추가)
  - Firebase 프로젝트 생성 및 연결
  - firebase_options.dart 생성

- [ ] **Firebase 프로젝트 설정**
  - Firestore 데이터베이스 생성
  - Storage 버킷 생성
  - Cloud Functions 프로젝트 생성
  - Cloud Messaging 설정

- [ ] **개발 도구 설정**
  - Git 브랜치 전략
  - CI/CD 파이프라인 (선택)
  - 코드 리뷰 프로세스

---

## 📝 다음 단계 권장 사항

### 즉시 시작 가능한 작업
1. **Flutter 프로젝트 구조 설정**
   - models, providers, services, screens, widgets 폴더 구조
   - 공통 컴포넌트 생성

2. **Firebase 기본 설정**
   - Firestore 컬렉션 생성
   - 보안 규칙 작성
   - Storage 경로 설정

3. **인증 시스템 구현**
   - AuthService 구현
   - AuthProvider 구현
   - 로그인/회원가입 화면 구현

4. **추모관 기본 CRUD 구현**
   - MemorialService 구현
   - MemorialProvider 구현
   - 추모관 생성/조회 화면 구현

### 단계별 개발 순서
1. **Week 1-2**: 인증 + 추모관 기본 CRUD
2. **Week 3-4**: 콘텐츠 관리 (사진, 편지)
3. **Week 5-6**: 댓글 + 영원한 시간
4. **Week 7-8**: 추모금 시스템 + 결제 연동
5. **Week 9-10**: 알림 시스템 + Cloud Functions
6. **Week 11-12**: 기도 요청 + 감정 공유
7. **Week 13-14**: 공유 + 통계 + 백업
8. **Week 15-16**: 프리미엄 기능 + 책장 디자인
9. **Week 17-18**: 테스트 + 버그 수정
10. **Week 19-20**: 배포 준비 + 출시

---

## 📌 참고사항

### 기획 문서
- 모든 기능은 `FEATURES.md`에 상세히 정의되어 있음
- 화면 레이아웃은 `SCREEN_LAYOUTS.md` 참고
- 데이터 구조는 `DATA_STRUCTURE.md` 참고

### UI 프리뷰
- 모든 화면의 UI 프리뷰가 구현되어 있음
- `lib/screens/preview_screens/` 폴더 참고
- 로그인 화면의 "UI 프리뷰" 버튼으로 확인 가능

### 초기 데이터
- AI를 활용한 초기 데이터 생성 가이드는 `INITIAL_DATA.md` 참고
- Firebase Functions 또는 Flutter 앱에서 구현 가능

